{# def
    user: User,
    statistics: dict[str, str],
    roles: list[str],
    discord_member: discord.Member,
    created_at: str,
    joined_at: str,
    campaign_experience: list[UserCampaignExperience],
    characters: list[Character],
    UserEditableInfo: UserEditableInfo,
#}

<PageLayout title={{ user.name }} _attrs={{ attrs }}>
    <global.PageTitle>

    {% if user.avatar_url %}
        <img src={{ user.avatar_url }} alt="User Avatar" class="img-fluid rounded-circle" width="75" height="75">
    {% endif %}
    {{ user.name }}</global.PageTitle>

    {# ########################################################## #}
    <div class="row mb-5">
        <div class="col-xl-4 col-md-5 mb-6">
            <div class="card h-100">
                <div class="card-body">
                    <h4>Discord Info</h4>
                    <hr class="border border-primary border-2 opacity-75">
                    <table class="table table-borderless table-sm">
                        <tr>
                            <td>
                                <strong>Roles</strong>
                            </td>
                            <td class="font-monospace">{{ roles | join(", ") }}</td>
                        </tr>
                        <tr>
                            <td>
                                <strong>Created at</strong>
                            </td>
                            <td class="font-monospace">{{ created_at }}</td>
                        </tr>
                        <tr>
                            <td>
                                <strong>Joined at</strong>
                            </td>
                            <td class="font-monospace">{{ joined_at }}</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-xl-4 col-md-6 mb-6">
            <div class="card h-100">
                <div class="card-body">
                    <global.Statistics statistics={{ statistics }} header_size="h4" title="Roll Statistics" />
                </div>
            </div>
        </div>
        <div class="col-xl-4 col-md-6 mb-6">
            <div class="card h-100">
                <div class="card-body">
                    <h4>Experience</h4>
                    <hr class="border border-primary border-2 opacity-75">
                    <table class="table table-borderless table-sm">
                        <tr>
                            <td>
                                <strong>Lifetime xp</strong>
                            </td>
                            <td class="font-monospace">{{ user.lifetime_experience }}</td>
                        </tr>
                        <tr>
                            <td>
                                <strong>Lifetime cp</strong>
                            </td>
                            <td class="font-monospace">{{ user.lifetime_cool_points }}</td>
                        </tr>
                        {% for campaign in campaign_experience %}
                            <tr>
                                <td colspan="2" class="text-center border-bottom lead">
                                    <small>{{ campaign.name }}</small>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Remaining XP</strong>
                                </td>
                                <td class="font-monospace">{{ campaign.xp }}</td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Total XP</strong>
                                </td>
                                <td class="font-monospace">{{ campaign.total_xp }}</td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Cool Points</strong>
                                </td>
                                <td class="font-monospace">{{ campaign.cp }}</td>
                            </tr>
                        {% endfor %}
                    </table>
                </div>
            </div>
        </div>
    </div>

    {% if session["USER_ID"] == user.id %}
        <button class="btn btn-outline-primary btn-sm ms-3 float-end"
                hx-get="{{ url_for(UserEditableInfo.MACRO.value.route, user_id=user.id) }}"
                hx-trigger="click"
                hx-target="#{{ UserEditableInfo.MACRO.value.div_id }}"
                hx-swap="innerHTML">New Macro</button>
    {% endif %}
    <h2>
        Macros&nbsp;&nbsp;<span class="text-muted fs-6 fw-light"><small>Speed dice rolls by preselecting traits</small></span>
    </h2>
    <hr class="border border-primary border-2 opacity-75">
    <div id="{{ UserEditableInfo.MACRO.value.div_id }}" class="mb-5">
        {% if user.macros %}

            <table class="table table-striped table-hover mb-5">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Abbreviation</th>
                        <th>Description</th>
                        <th>Trait1</th>
                        <th>Trait2</th>
                        {% if session["USER_ID"] == user.id %}<th></th>{% endif %}
                    </tr>
                </thead>
                <tbody>
                    {% for macro in user.macros | sort(attribute="name") %}
                        <tr>
                            <td>{{ macro.name }}</td>
                            <td>{{ macro.abbreviation }}</td>
                            <td>{{ macro.description }}</td>
                            <td>{{ macro.trait_one }}</td>
                            <td>{{ macro.trait_two }}</td>
                            {% if session["USER_ID"] == user.id %}
                                <td>
                                    <div class="btn-group float-end">
                                        <button class="btn btn-sm btn-outline-primary"
                                                style="--bs-btn-padding-y: .25rem;
                                                       --bs-btn-padding-x: .5rem;
                                                       --bs-btn-font-size: .75rem"
                                                hx-get="{{ url_for(UserEditableInfo.MACRO.value.route, user_id=user.id, macro_id=macro.uuid) }}"
                                                hx-trigger="click"
                                                hx-target="#{{ UserEditableInfo.MACRO.value.div_id }}"
                                                hx-swap="innerHTML">Edit</button>

                                        <button class="btn btn-sm btn-outline-danger"
                                                style="--bs-btn-padding-y: .25rem;
                                                       --bs-btn-padding-x: .5rem;
                                                       --bs-btn-font-size: .75rem"
                                                hx-delete="{{ url_for(UserEditableInfo.MACRO.value.route, user_id=user.id, macro_id=macro.uuid) }}"
                                                hx-trigger="click"
                                                hx-target="#{{ UserEditableInfo.MACRO.value.div_id }}"
                                                hx-swap="innerHTML">Delete</button>
                                    </div>
                                </td>
                            {% endif %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>No macros.</p>
        {% endif %}
    </div>

    {% if session["USER_ID"] == user.id %}
        <a class="btn btn-outline-primary btn-sm ms-3 float-end"
           href="{{ url_for('character_create.start') }}">Create Character</a>
    {% endif %}
    <h2>Characters</h2>
    <hr class="border border-primary border-2 opacity-75">
    <div id="characters" class="mb-5">
        {% if user.characters %}
            <table class="table table-hover">

                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Class</th>
                        <th>Alive</th>
                        {% if session["IS_STORYTELLER"] %}<th>Type</th>{% endif %}
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for character in characters | sort(attribute="name") %}
                        <tr>
                            <td>{{ character.name }}</td>
                            <td>{{ character.char_class_name | title }}</td>
                            <td>{{ character.is_alive }}</td>
                            {% if session["IS_STORYTELLER"] %}
                                <td>{{ 'Player' if character.type_player else 'Storyteller' }}</td>
                            {% endif %}
                            <td>
                                <a class="btn btn-primary btn-sm"
                                   href="{{ url_for('character_view.view', character_id=character.id) }}">View</a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>

        {% else %}
            <p>
                No characters.  <a href="{{ url_for('character_create.start') }}">Create one</a>
            </p>
        {% endif %}
    </div>

</PageLayout>
